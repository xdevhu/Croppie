/*************************
 * Croppie
 * Copyright 2018
 * Foliotek
 * Version: 2.6.2
 *************************/(function(e,t){typeof define=="function"&&define.amd?define(t):typeof exports=="object"&&typeof exports.nodeName!="string"?module.exports=t():e.Croppie=t()})(typeof self!="undefined"?self:this,function(){function u(n){if(n in t)return n;var r=n[0].toUpperCase()+n.slice(1),i=e.length;while(i--){n=e[i]+r;if(n in t)return n}}function a(e,t){var i=n.indexOf(e)>-1?n:r,s=i.indexOf(e),o=t/90%i.length;return i[(i.length+s+o%i.length)%i.length]}function f(e,t){e=e||{};for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},f(e[n],t[n])):e[n]=t[n];return e}function l(e){return f({},e)}function c(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)},u=n&&!r;clearTimeout(r),r=setTimeout(o,t),u&&e.apply(i,s)}}function h(e){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")}function p(e,t,n){if(typeof t=="string"){var r=t;t={},t[r]=n}for(var i in t)e.style[i]=t[i]}function d(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function v(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(t,"")}function m(e,t){for(var n in t)e.setAttribute(n,t[n])}function g(e){return parseInt(e,10)}function y(e,t){var n=new Image;return n.style.opacity="0",new Promise(function(r,i){function s(){n.style.opacity="1",setTimeout(function(){r(n)},1)}n.removeAttribute("crossOrigin"),e.match(/^https?:\/\/|^\/\//)&&n.setAttribute("crossOrigin",t.crossOrigin),n.onload=function(){t.doExif?EXIF.getData(n,function(){s()}):s()},n.onerror=function(e){n.style.opacity=1,setTimeout(function(){i(e)},1)},n.src=e})}function b(e,t){var n=e.naturalWidth,r=e.naturalHeight,i=t||x(e);if(i&&i>=5){var s=n;n=r,r=s}return{width:n,height:r}}function x(e){return e.exifdata&&e.exifdata.Orientation?g(e.exifdata.Orientation):1}function T(e,t,n){var r=t.width,i=t.height,s=e.getContext("2d");e.width=t.width,e.height=t.height,s.save();switch(n){case 2:s.translate(r,0),s.scale(-1,1);break;case 3:s.translate(r,i),s.rotate(180*Math.PI/180);break;case 4:s.translate(0,i),s.scale(1,-1);break;case 5:e.width=i,e.height=r,s.rotate(90*Math.PI/180),s.scale(1,-1);break;case 6:e.width=i,e.height=r,s.rotate(90*Math.PI/180),s.translate(0,-i);break;case 7:e.width=i,e.height=r,s.rotate(-90*Math.PI/180),s.translate(-r,i),s.scale(1,-1);break;case 8:e.width=i,e.height=r,s.translate(0,r),s.rotate(-90*Math.PI/180)}s.drawImage(t,0,0,r,i),s.restore()}function N(){var e=this,t="croppie-container",n=e.options.viewport.type?"cr-vp-"+e.options.viewport.type:null,r,i,s,o,u,a;e.options.useCanvas=e.options.enableOrientation||C.call(e),e.data={},e.elements={},r=e.elements.boundary=document.createElement("div"),s=e.elements.viewport=document.createElement("div"),i=e.elements.img=document.createElement("img"),o=e.elements.overlay=document.createElement("div"),e.options.useCanvas?(e.elements.canvas=document.createElement("canvas"),e.elements.preview=e.elements.canvas):e.elements.preview=i,d(r,"cr-boundary"),r.setAttribute("aria-dropeffect","none"),u=e.options.boundary.width,a=e.options.boundary.height,p(r,{width:u+(isNaN(u)?"":"px"),height:a+(isNaN(a)?"":"px")}),d(s,"cr-viewport"),n&&d(s,n),p(s,{width:e.options.viewport.width+"px",height:e.options.viewport.height+"px"}),s.setAttribute("tabindex",0),d(e.elements.preview,"cr-image"),m(e.elements.preview,{alt:"preview","aria-grabbed":"false"}),d(o,"cr-overlay"),e.element.appendChild(r),r.appendChild(e.elements.preview),r.appendChild(s),r.appendChild(o),d(e.element,t),e.options.customClass&&d(e.element,e.options.customClass),D.call(this),e.options.enableZoom&&A.call(e),e.options.enableResize&&k.call(e)}function C(){return this.options.enableExif&&window.EXIF}function k(){function h(t){if(t.button!==undefined&&t.button!==0)return;t.preventDefault();if(n)return;var u=e.elements.overlay.getBoundingClientRect();n=!0,i=t.pageX,s=t.pageY,r=t.currentTarget.className.indexOf("vertical")!==-1?"v":"h",a=u.width,f=u.height;if(t.touches){var l=t.touches[0];i=l.pageX,s=l.pageY}window.addEventListener("mousemove",v),window.addEventListener("touchmove",v),window.addEventListener("mouseup",m),window.addEventListener("touchend",m),document.body.style[o]="none"}function v(n){var o=n.pageX,l=n.pageY;n.preventDefault();if(n.touches){var c=n.touches[0];o=c.pageX,l=c.pageY}var h=o-i,d=l-s,v=e.options.viewport.height+d,m=e.options.viewport.width+h;r==="v"&&v>=u&&v<=f?(p(t,{height:v+"px"}),e.options.boundary.height+=d,p(e.elements.boundary,{height:e.options.boundary.height+"px"}),e.options.viewport.height+=d,p(e.elements.viewport,{height:e.options.viewport.height+"px"})):r==="h"&&m>=u&&m<=a&&(p(t,{width:m+"px"}),e.options.boundary.width+=h,p(e.elements.boundary,{width:e.options.boundary.width+"px"}),e.options.viewport.width+=h,p(e.elements.viewport,{width:e.options.viewport.width+"px"})),P.call(e),I.call(e),_.call(e),B.call(e),s=l,i=o}function m(){n=!1,window.removeEventListener("mousemove",v),window.removeEventListener("touchmove",v),window.removeEventListener("mouseup",m),window.removeEventListener("touchend",m),document.body.style[o]=""}var e=this,t=document.createElement("div"),n=!1,r,i,s,u=50,a,f,l,c;d(t,"cr-resizer"),p(t,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(l=document.createElement("div"),d(l,"cr-resizer-vertical"),t.appendChild(l)),this.options.resizeControls.width&&(c=document.createElement("div"),d(c,"cr-resizer-horisontal"),t.appendChild(c)),l&&(l.addEventListener("mousedown",h),l.addEventListener("touchstart",h)),c&&(c.addEventListener("mousedown",h),c.addEventListener("touchstart",h)),this.elements.boundary.appendChild(t)}function L(e){if(this.options.enableZoom){var t=this.elements.zoomer,n=K(e,4);t.value=Math.max(parseFloat(t.min),Math.min(parseFloat(t.max),n)).toString()}}function A(){function r(){O.call(e,{value:parseFloat(n.value),origin:new S(e.elements.preview),viewportRect:e.elements.viewport.getBoundingClientRect(),transform:E.parse(e.elements.preview)})}function i(t){var n,i;if(e.options.mouseWheelZoom==="ctrl"&&t.ctrlKey!==!0)return 0;t.wheelDelta?n=t.wheelDelta/1200:t.deltaY?n=t.deltaY/1060:t.detail?n=t.detail/-60:n=0,i=e._currentZoom+n*e._currentZoom,t.preventDefault(),L.call(e,i),r.call(e)}var e=this,t=e.elements.zoomerWrap=document.createElement("div"),n=e.elements.zoomer=document.createElement("input");d(t,"cr-slider-wrap"),d(n,"cr-slider"),n.type="range",n.step="0.0001",n.value="1",n.style.display=e.options.showZoomer?"":"none",n.setAttribute("aria-label","zoom"),e.element.appendChild(t),t.appendChild(n),e._currentZoom=1,e.elements.zoomer.addEventListener("input",r),e.elements.zoomer.addEventListener("change",r),e.options.mouseWheelZoom&&(e.elements.boundary.addEventListener("mousewheel",i),e.elements.boundary.addEventListener("DOMMouseScroll",i))}function O(e){function u(){var e={};e[s]=n.toString(),e[i]=o.toString(),p(t.elements.preview,e)}var t=this,n=e?e.transform:E.parse(t.elements.preview),r=e?e.viewportRect:t.elements.viewport.getBoundingClientRect(),o=e?e.origin:new S(t.elements.preview);t._currentZoom=e?e.value:t._currentZoom,n.scale=t._currentZoom,t.elements.zoomer.setAttribute("aria-valuenow",t._currentZoom),u();if(t.options.enforceBoundary){var a=M.call(t,r),f=a.translate,l=a.origin;n.x>=f.maxX&&(o.x=l.minX,n.x=f.maxX),n.x<=f.minX&&(o.x=l.maxX,n.x=f.minX),n.y>=f.maxY&&(o.y=l.minY,n.y=f.maxY),n.y<=f.minY&&(o.y=l.maxY,n.y=f.minY)}u(),H.call(t),B.call(t)}function M(e){var t=this,n=t._currentZoom,r=e.width,i=e.height,s=t.elements.boundary.clientWidth/2,o=t.elements.boundary.clientHeight/2,u=t.elements.preview.getBoundingClientRect(),a=u.width,f=u.height,l=r/2,c=i/2,h=(l/n-s)*-1,p=h-(a*(1/n)-r*(1/n)),d=(c/n-o)*-1,v=d-(f*(1/n)-i*(1/n)),m=1/n*l,g=a*(1/n)-m,y=1/n*c,b=f*(1/n)-y;return{translate:{maxX:h,minX:p,maxY:d,minY:v},origin:{maxX:g,minX:m,maxY:b,minY:y}}}function _(e){var t=this,n=t._currentZoom,r=t.elements.preview.getBoundingClientRect(),o=t.elements.viewport.getBoundingClientRect(),u=E.parse(t.elements.preview.style[s]),a=new S(t.elements.preview),f=o.top-r.top+o.height/2,l=o.left-r.left+o.width/2,c={},h={};if(e){var d=a.x,v=a.y,m=u.x,g=u.y;c.y=d,c.x=v,u.y=m,u.x=g}else c.y=f/n,c.x=l/n,h.y=(c.y-a.y)*(1-n),h.x=(c.x-a.x)*(1-n),u.x-=h.x,u.y-=h.y;var y={};y[i]=c.x+"px "+c.y+"px",y[s]=u.toString(),p(t.elements.preview,y)}function D(){function f(t,n){var r=e.elements.preview.getBoundingClientRect(),i=a.y+n,s=a.x+t;e.options.enforceBoundary?(u.top>r.top+n&&u.bottom<r.bottom+n&&(a.y=i),u.left>r.left+t&&u.right<r.right+t&&(a.x=s)):(a.y=i,a.x=s)}function l(t){e.elements.preview.setAttribute("aria-grabbed",t),e.elements.boundary.setAttribute("aria-dropeffect",t?"move":"none")}function c(t){function c(e){switch(e){case n:return[1,0];case r:return[0,1];case i:return[-1,0];case s:return[0,-1]}}var n=37,r=38,i=39,s=40;if(!t.shiftKey||t.keyCode!==r&&t.keyCode!==s){if(e.options.enableKeyMovement&&t.keyCode>=37&&t.keyCode<=40){t.preventDefault();var l=c(t.keyCode);a=E.parse(e.elements.preview),document.body.style[o]="none",u=e.elements.viewport.getBoundingClientRect(),d(l)}}else{var f;t.keyCode===r?f=parseFloat(e.elements.zoomer.value)+parseFloat(e.elements.zoomer.step):f=parseFloat(e.elements.zoomer.value)-parseFloat(e.elements.zoomer.step),e.setZoom(f)}}function d(t){var n=t[0],r=t[1],u={};f(n,r),u[s]=a.toString(),p(e.elements.preview,u),P.call(e),document.body.style[o]="",_.call(e),B.call(e),i=0}function v(i){if(i.button!==undefined&&i.button!==0)return;i.preventDefault();if(t)return;t=!0,n=i.pageX,r=i.pageY;if(i.touches){var s=i.touches[0];n=s.pageX,r=s.pageY}l(t),a=E.parse(e.elements.preview),window.addEventListener("mousemove",m),window.addEventListener("touchmove",m),window.addEventListener("mouseup",g),window.addEventListener("touchend",g),document.body.style[o]="none",u=e.elements.viewport.getBoundingClientRect()}function m(t){t.preventDefault();var o=t.pageX,u=t.pageY;if(t.touches){var l=t.touches[0];o=l.pageX,u=l.pageY}var c=o-n,d=u-r,v={};if(t.type==="touchmove"&&t.touches.length>1){var m=t.touches[0],g=t.touches[1],y=Math.sqrt((m.pageX-g.pageX)*(m.pageX-g.pageX)+(m.pageY-g.pageY)*(m.pageY-g.pageY));i||(i=y/e._currentZoom);var b=y/i;L.call(e,b),h(e.elements.zoomer);return}f(c,d),v[s]=a.toString(),p(e.elements.preview,v),P.call(e),r=u,n=o}function g(){t=!1,l(t),window.removeEventListener("mousemove",m),window.removeEventListener("touchmove",m),window.removeEventListener("mouseup",g),window.removeEventListener("touchend",g),document.body.style[o]="",_.call(e),B.call(e),i=0}var e=this,t=!1,n,r,i,u,a;e.elements.overlay.addEventListener("mousedown",v),e.elements.viewport.addEventListener("keydown",c),e.elements.overlay.addEventListener("touchstart",v)}function P(){if(!this.elements)return;var e=this,t=e.elements.boundary.getBoundingClientRect(),n=e.elements.preview.getBoundingClientRect();p(e.elements.overlay,{width:n.width+"px",height:n.height+"px",top:n.top-t.top+"px",left:n.left-t.left+"px"})}function B(){var e=this,t=e.get();if(!j.call(e))return;e.options.update.call(e,t);if(e.$&&typeof Prototype=="undefined")e.$(e.element).trigger("update.croppie",t);else{var n;window.CustomEvent?n=new CustomEvent("update",{detail:t}):(n=document.createEvent("CustomEvent"),n.initCustomEvent("update",!0,!0,t)),e.element.dispatchEvent(n)}}function j(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function F(){var e=this,t=1,n={},r=e.elements.preview,o,u=new E(0,0,t),a=new S,f=j.call(e);if(!f||e.data.bound)return;e.data.bound=!0,n[s]=u.toString(),n[i]=a.toString(),n.opacity=1,p(r,n),o=e.elements.preview.getBoundingClientRect(),e._originalImageWidth=o.width,e._originalImageHeight=o.height,e.data.orientation=x(e.elements.img),e.options.enableZoom?I.call(e,!0):e._currentZoom=t,u.scale=e._currentZoom,n[s]=u.toString(),p(r,n),e.data.points.length?q.call(e,e.data.points):R.call(e),_.call(e),P.call(e)}function I(e){var t=this,n=0,r=t.options.maxZoom||1.5,i,s,o=t.elements.zoomer,u=parseFloat(o.value),a=t.elements.boundary.getBoundingClientRect(),f=b(t.elements.img,t.data.orientation),l=t.elements.viewport.getBoundingClientRect(),c,p;t.options.enforceBoundary&&(c=l.width/f.width,p=l.height/f.height,n=Math.max(c,p)),n>=r&&(r=n+1),o.min=K(n,4),o.max=K(r,4),!e&&(u<o.min||u>o.max)?L.call(t,u<o.min?o.min:o.max):e&&(s=Math.max(a.width/f.width,a.height/f.height),i=t.data.boundZoom!==null?t.data.boundZoom:s,L.call(t,i)),h(o)}function q(e){if(e.length!==4)throw"Croppie - Invalid number of points supplied: "+e;var t=this,n=e[2]-e[0],r=t.elements.viewport.getBoundingClientRect(),o=t.elements.boundary.getBoundingClientRect(),u={left:r.left-o.left,top:r.top-o.top},a=r.width/n,f=e[1],l=e[0],c=-1*e[1]+u.top,h=-1*e[0]+u.left,d={};d[i]=l+"px "+f+"px",d[s]=(new E(h,c,a)).toString(),p(t.elements.preview,d),L.call(t,a),t._currentZoom=a}function R(){var e=this,t=e.elements.preview.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),r=e.elements.boundary.getBoundingClientRect(),i=n.left-r.left,o=n.top-r.top,u=i-(t.width-n.width)/2,a=o-(t.height-n.height)/2,f=new E(u,a,e._currentZoom);p(e.elements.preview,s,f.toString())}function U(e){var t=this,n=t.elements.canvas,r=t.elements.img,i=n.getContext("2d");i.clearRect(0,0,n.width,n.height),n.width=r.width,n.height=r.height;var s=t.options.enableOrientation&&e||x(r);T(n,r,s)}function z(e){var t=this,n=e.points,r=g(n[0]),i=g(n[1]),s=g(n[2]),o=g(n[3]),u=s-r,a=o-i,f=e.circle,l=document.createElement("canvas"),c=l.getContext("2d"),h=0,p=0,d=e.outputWidth||u,v=e.outputHeight||a;return l.width=d,l.height=v,e.backgroundColor&&(c.fillStyle=e.backgroundColor,c.fillRect(0,0,d,v)),t.options.enforceBoundary!==!1&&(u=Math.min(u,t._originalImageWidth),a=Math.min(a,t._originalImageHeight)),c.drawImage(this.elements.preview,r,i,u,a,h,p,d,v),f&&(c.fillStyle="#fff",c.globalCompositeOperation="destination-in",c.beginPath(),c.arc(l.width/2,l.height/2,l.width/2,0,Math.PI*2,!0),c.closePath(),c.fill()),l}function W(e){var t=e.points,n=document.createElement("div"),r=document.createElement("img"),i=t[2]-t[0],s=t[3]-t[1];return d(n,"croppie-result"),n.appendChild(r),p(r,{left:-1*t[0]+"px",top:-1*t[1]+"px"}),r.src=e.url,p(n,{width:i+"px",height:s+"px"}),n}function X(e){return z.call(this,e).toDataURL(e.format,e.quality)}function V(e){var t=this;return new Promise(function(n){z.call(t,e).toBlob(function(e){n(e)},e.format,e.quality)})}function $(e){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(t){e.classList.add(t)}),this.elements.img.parentNode.replaceChild(e,this.elements.img),this.elements.preview=e),this.elements.img=e}function J(e,t){var n=this,r,i=[],s=null,o=C.call(n);if(typeof e=="string")r=e,e={};else if(Array.isArray(e))i=e.slice();else{if(typeof e=="undefined"&&n.data.url)return F.call(n),B.call(n),null;r=e.url,i=e.points||[],s=typeof e.zoom=="undefined"?null:e.zoom}n.data.bound=!1,n.data.url=r||n.data.url,n.data.boundZoom=s;var u={doExif:o,crossOrigin:n.options.crossOrigin};return y(r,u).then(function(r){$.call(n,r);if(!i.length){var s=b(r),o=n.elements.viewport.getBoundingClientRect(),u=o.width/o.height,a=s.width/s.height,f,l;a>u?(l=s.height,f=l*u):(f=s.width,l=s.height/u);var c=(s.width-f)/2,h=(s.height-l)/2,p=c+f,d=h+l;n.data.points=[c,h,p,d]}else n.options.relative&&(i=[i[0]*r.naturalWidth/100,i[1]*r.naturalHeight/100,i[2]*r.naturalWidth/100,i[3]*r.naturalHeight/100]);n.data.points=i.map(function(e){return parseFloat(e)}),n.options.useCanvas&&U.call(n,e.orientation),F.call(n),B.call(n),t&&t()})}function K(e,t){return parseFloat(e).toFixed(t||0)}function Q(){var e=this,t=e.elements.preview.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),r=n.left-t.left,i=n.top-t.top,s=(n.width-e.elements.viewport.offsetWidth)/2,o=(n.height-e.elements.viewport.offsetHeight)/2,u=r+e.elements.viewport.offsetWidth+s,a=i+e.elements.viewport.offsetHeight+o,f=e._currentZoom;if(f===Infinity||isNaN(f))f=1;var l=e.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return r=Math.max(l,r/f),i=Math.max(l,i/f),u=Math.max(l,u/f),a=Math.max(l,a/f),{points:[K(r),K(i),K(u),K(a)],zoom:f,orientation:e.data.orientation}}function Z(e){var t=this,n=Q.call(t),r=f(l(G),l(e)),i=typeof e=="string"?e:r.type||"base64",s=r.size||"viewport",o=r.format,u=r.quality,a=r.backgroundColor,c=typeof r.circle=="boolean"?r.circle:t.options.viewport.type==="circle",h=t.elements.viewport.getBoundingClientRect(),p=h.width/h.height,d;return s==="viewport"?(n.outputWidth=h.width,n.outputHeight=h.height):typeof s=="object"&&(s.width&&s.height?(n.outputWidth=s.width,n.outputHeight=s.height):s.width?(n.outputWidth=s.width,n.outputHeight=s.width/p):s.height&&(n.outputWidth=s.height*p,n.outputHeight=s.height)),Y.indexOf(o)>-1&&(n.format="image/"+o,n.quality=u),n.circle=c,n.url=t.data.url,n.backgroundColor=a,d=new Promise(function(e){switch(i.toLowerCase()){case"rawcanvas":e(z.call(t,n));break;case"canvas":case"base64":e(X.call(t,n));break;case"blob":V.call(t,n).then(e);break;default:e(W.call(t,n))}}),d}function et(){F.call(this)}function tt(e){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var t=this,n=t.elements.canvas;t.data.orientation=a(t.data.orientation,e),T(n,t.elements.img,t.data.orientation),_.call(t,!0),I.call(t)}function nt(){var e=this;e.element.removeChild(e.elements.boundary),v(e.element,"croppie-container"),e.options.enableZoom&&e.element.removeChild(e.elements.zoomerWrap),delete e.elements}function it(e,t){if(e.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");this.element=e,this.options=f(l(it.defaults),t);if(this.element.tagName.toLowerCase()==="img"){var n=this.element;d(n,"cr-original-image"),m(n,{"aria-hidden":"true",alt:""});var r=document.createElement("div");this.element.parentNode.appendChild(r),r.appendChild(n),this.element=r,this.options.url=this.options.url||n.src}N.call(this);if(this.options.url){var i={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,J.call(this,i)}}typeof Promise!="function"&&!function(e){function t(e,t){return function(){e.apply(t,arguments)}}function n(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],a(e,t(i,this),t(s,this))}function r(e){var t=this;return null===this._state?void this._deferreds.push(e):void l(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return void (t._state?e.resolve:e.reject)(t._value);var r;try{r=n(t._value)}catch(i){return void e.reject(i)}e.resolve(r)})}function i(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void a(t(n,e),t(i,this),t(s,this))}this._state=!0,this._value=e,o.call(this)}catch(r){s.call(this,r)}}function s(e){this._state=!1,this._value=e,o.call(this)}function o(){for(var e=0,t=this._deferreds.length;t>e;e++)r.call(this,this._deferreds[e]);this._deferreds=null}function u(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function a(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(i){if(r)return;r=!0,n(i)}}var f=setTimeout,l="function"==typeof setImmediate&&setImmediate||function(e){f(e,1)},c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){var i=this;return new n(function(n,s){r.call(i,new u(e,t,n,s))})},n.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&c(arguments[0])?arguments[0]:arguments);return new n(function(t,n){function r(s,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var u=o.then;if("function"==typeof u)return void u.call(o,function(e){r(s,e)},n)}e[s]=o,0===--i&&t(e)}catch(a){n(a)}}if(0===e.length)return t([]);for(var i=e.length,s=0;s<e.length;s++)r(s,e[s])})},n.resolve=function(e){return e&&"object"==typeof e&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,n){n(e)})},n.race=function(e){return new n(function(t,n){for(var r=0,i=e.length;i>r;r++)e[r].then(t,n)})},n._setImmediateFn=function(e){l=e},"undefined"!=typeof module&&module.exports?module.exports=n:e.Promise||(e.Promise=n)}(this),typeof window.CustomEvent!="function"&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){var r=atob(this.toDataURL(t,n).split(",")[1]),i=r.length,s=new Uint8Array(i);for(var o=0;o<i;o++)s[o]=r.charCodeAt(o);e(new Blob([s],{type:t||"image/png"}))}});var e=["Webkit","Moz","ms"],t=document.createElement("div").style,n=[1,8,3,6],r=[2,7,4,5],i,s,o;s=u("transform"),i=u("transformOrigin"),o=u("userSelect");var w={translate3d:{suffix:", 0px"},translate:{suffix:""}},E=function(e,t,n){this.x=parseFloat(e),this.y=parseFloat(t),this.scale=parseFloat(n)};E.parse=function(e){return e.style?E.parse(e.style[s]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?E.fromMatrix(e):E.fromString(e)},E.fromMatrix=function(e){var t=e.substring(7).split(",");if(!t.length||e==="none")t=[1,0,0,1,0,0];return new E(g(t[4]),g(t[5]),parseFloat(t[0]))},E.fromString=function(e){var t=e.split(") "),n=t[0].substring(it.globals.translate.length+1).split(","),r=t.length>1?t[1].substring(6):1,i=n.length>1?n[0]:0,s=n.length>1?n[1]:0;return new E(i,s,r)},E.prototype.toString=function(){var e=w[it.globals.translate].suffix||"";return it.globals.translate+"("+this.x+"px, "+this.y+"px"+e+") scale("+this.scale+")"};var S=function(e){if(!e||!e.style[i]){this.x=0,this.y=0;return}var t=e.style[i].split(" ");this.x=parseFloat(t[0]),this.y=parseFloat(t[1])};S.prototype.toString=function(){return this.x+"px "+this.y+"px"};var H=c(P,500),G={type:"canvas",format:"png",quality:1},Y=["jpeg","webp","png"];if(window.jQuery){var rt=window.jQuery;rt.fn.croppie=function(e){var t=typeof e;if(t==="string"){var n=Array.prototype.slice.call(arguments,1),r=rt(this).data("croppie");return e==="get"?r.get():e==="result"?r.result.apply(r,n):e==="bind"?r.bind.apply(r,n):this.each(function(){var t=rt(this).data("croppie");if(!t)return;var r=t[e];if(!rt.isFunction(r))throw"Croppie "+e+" method not found";r.apply(t,n),e==="destroy"&&rt(this).removeData("croppie")})}return this.each(function(){var t=new it(this,e);t.$=rt,rt(this).data("croppie",t)})}}return it.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,crossOrigin:"anonymous",update:function(){}},it.globals={translate:"translate3d"},f(it.prototype,{bind:function(e,t){return J.call(this,e,t)},get:function(){var e=Q.call(this),t=e.points;return this.options.relative&&(t[0]/=this.elements.img.naturalWidth/100,t[1]/=this.elements.img.naturalHeight/100,t[2]/=this.elements.img.naturalWidth/100,t[3]/=this.elements.img.naturalHeight/100),e},result:function(e){return Z.call(this,e)},refresh:function(){return et.call(this)},setZoom:function(e){L.call(this,e),h(this.elements.zoomer)},rotate:function(e){tt.call(this,e)},destroy:function(){return nt.call(this)}}),it});